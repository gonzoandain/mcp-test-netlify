---
phase: 04-header-routing-cleanup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/routing.ts
  - src/cache.ts
  - src/validation.ts
autonomous: true

must_haves:
  truths:
    - "routing.ts no longer exists in src/"
    - "cache.ts no longer exists in src/"
    - "TypeScript compiles without errors"
  artifacts:
    - path: "src/validation.ts"
      provides: "clientId validation without routing.ts reference"
      contains: "validateClientId"
  key_links: []
---

<objective>
Delete legacy routing infrastructure files (routing.ts, cache.ts) and update validation.ts comment.

Purpose: Complete the cleanup of header-based routing that became obsolete in Phase 3 when tools started accepting clientId as parameter.
Output: Smaller codebase with no dead files, clean validation module.
</objective>

<execution_context>
@/Users/gonzo/.claude/get-shit-done/workflows/execute-plan.md
@/Users/gonzo/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-header-routing-cleanup/04-CONTEXT.md
@.planning/phases/04-header-routing-cleanup/04-RESEARCH.md
@src/validation.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Delete legacy routing files</name>
  <files>src/routing.ts, src/cache.ts</files>
  <action>
Delete the following files that are no longer imported anywhere:
- src/routing.ts (144 lines - header validation logic)
- src/cache.ts (129 lines - per-client server caching)

These files were verified to have no imports via grep search. Phase 3 already removed all references when implementing clientId as tool parameter.

Use rm command or equivalent file deletion. Do NOT attempt to "archive" or "backup" - this is a clean removal.
  </action>
  <verify>
Run: `ls src/routing.ts src/cache.ts 2>&1` - should show "No such file or directory" for both
Run: `npx tsc --noEmit` - should compile without errors
  </verify>
  <done>routing.ts and cache.ts deleted, TypeScript still compiles</done>
</task>

<task type="auto">
  <name>Task 2: Update validation.ts comment</name>
  <files>src/validation.ts</files>
  <action>
Update line 20 comment in src/validation.ts:

FROM:
```typescript
  // Normalize: trim and lowercase (matching routing.ts pattern)
```

TO:
```typescript
  // Normalize: trim and lowercase for consistent lookup
```

This removes the reference to the deleted routing.ts file while maintaining the explanation of why normalization is performed.
  </action>
  <verify>
Run: `grep -n "routing.ts" src/validation.ts` - should return no matches
Run: `grep -n "Normalize" src/validation.ts` - should show updated comment
  </verify>
  <done>validation.ts no longer references deleted routing.ts file</done>
</task>

</tasks>

<verification>
1. `ls src/*.ts` shows: config.ts, httpClient.ts, oneappServer.ts, types.ts, validation.ts (5 files, NOT 7)
2. `npx tsc --noEmit` compiles successfully
3. `grep -r "routing.ts\|cache.ts" src/` returns no matches
</verification>

<success_criteria>
- routing.ts deleted from src/
- cache.ts deleted from src/
- validation.ts comment updated (no routing.ts reference)
- TypeScript builds without errors
- Requirements CLEN-03 and CLEN-04 satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/04-header-routing-cleanup/04-01-SUMMARY.md`
</output>
